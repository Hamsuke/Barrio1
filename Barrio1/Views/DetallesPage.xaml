<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Barrio1.Views.DetallesPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:Barrio1.Models"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:viewmodel="clr-namespace:Barrio1.ViewModels"
    x:DataType="viewmodel:DetallesViewModel"
    >

    <ContentPage.Resources>
        <toolkit:BoolToObjectConverter
            x:Key="BoolToObjectConverter"
            FalseObject="Pago pendiente"
            TrueObject="Pago Completo" />
    </ContentPage.Resources>

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior Command="{Binding GetNotaCommand}" EventName="Appearing"/>
    </ContentPage.Behaviors>

    <StackLayout>
        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" RowSpacing="6" ColumnSpacing="6">

            <StackLayout Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2">
                <Border Padding="10"
                        Stroke="Dimgray"
                        StrokeThickness="1"
                >
                    <Grid RowDefinitions="auto,auto,auto,auto,auto" ColumnDefinitions="*,*,*,*" ColumnSpacing="20">
                        <Label Text="Nota" Grid.ColumnSpan="4" FontSize="Title" HorizontalOptions="Center" Grid.Row="0" Grid.Column="0"/>

                        <Label Grid.Column="0" Grid.Row="1" Text="Vendedor:"/>
                        <Label Grid.Column="0" Grid.Row="2" Text="Cliente:"/>
                        <Label Grid.Column="0" Grid.Row="3" Text="Numero:"/>

                        <Label Grid.Column="1" Grid.Row="1" Text="{Binding Venta.vendor}"/>
                        <Label Grid.Column="1" Grid.Row="2" Text="{Binding Venta.name}"/>
                        <Label Grid.Column="1" Grid.Row="3" Text="{Binding Venta.id}"/>

                        <Label Grid.Column="2" Grid.Row="1" Text="Cantidad a pagar:" />
                        <Label Grid.Column="2" Grid.Row="2" Text="Cantidad pagada:" />
                        <Label Grid.Column="2" Grid.Row="3" Text="Estado de nota:" />
                        <Label Grid.Column="2" Grid.Row="4" Text="Metodo de pago:" />

                        <Label Grid.Column="3" Grid.Row="1" Text="{Binding Venta.costo}"/>
                        <Label Grid.Column="3" Grid.Row="2" Text="{Binding Venta.pago}" />
                        <Label Grid.Column="3" Grid.Row="3" Text="{Binding Venta.est, Converter={StaticResource BoolToObjectConverter}}"/>
                        <Label Grid.Column="3" Grid.Row="4" Text="{Binding Venta.metodo}" />
                    </Grid>
                </Border>
            </StackLayout>

            <!-- CollectionView for SalidasBotella -->
            <StackLayout Grid.Row="1" Grid.Column="0">
                <!-- Frame to wrap the CollectionView -->
                <Border Padding="10"
                        Stroke="Dimgray"
                        StrokeThickness="1"
                        >
                    <StackLayout>
                        <!-- Label for "Botellas" -->
                        <Label Text="Botellas" FontSize="Medium" VerticalOptions="Center" HorizontalOptions="Center" Margin="0,0,0,10"/>

                        <!-- CollectionView for SalidasBotella -->
                        <CollectionView ItemsSource="{Binding SalidasBotella}">
                            <CollectionView.ItemTemplate>
                                <DataTemplate x:DataType="model:SalidasBotella">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                        <!-- Botella Label -->
                                        <Label Grid.Row="1" FontSize="12" VerticalOptions="Center" Grid.Column="0" Text="{Binding botella}"/>

                                        <!-- Cantidad Label -->
                                        <Label Grid.Row="1" FontSize="12" VerticalTextAlignment="Center" Grid.Column="1" Text="{Binding cant}"/>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </StackLayout>
                </Border>
            </StackLayout>

            <!-- CollectionView for SalidasBotella -->
            <StackLayout Grid.Row="1" Grid.Column="1">
                <!-- Frame to wrap the CollectionView -->
                <Border Padding="10"
                        Stroke="Dimgray"
                        StrokeThickness="1"
                        >
                    <StackLayout>
                        <!-- Label for "Botellas" -->
                        <Label Text="Barriles" FontSize="Medium" HorizontalOptions="Center" VerticalOptions="Center" Margin="0,0,0,10"/>

                        <!-- CollectionView for SalidasBotella -->
                        <CollectionView ItemsSource="{Binding SalidasBarril}">
                            <CollectionView.ItemTemplate>
                                <DataTemplate x:DataType="model:SalidasBarril">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                        <!-- Botella Label -->
                                        <Label Grid.Row="1" FontSize="10" VerticalOptions="Center" Grid.Column="0" Text="{Binding barril}"/>

                                        <!-- Cantidad Label -->
                                        <Label Grid.Row="1" FontSize="10" VerticalOptions="Center" Grid.Column="1" Text="{Binding cant}"/>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </StackLayout>
                </Border>
            </StackLayout>
        </Grid>
    </StackLayout>
</ContentPage>
